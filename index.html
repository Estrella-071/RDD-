<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å¡ç‰‡æ•¸ / å›åˆæ•¸ æ›ç®—å™¨</title>
  <!-- è¼‰å…¥ Roboto å­—é«” -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <!-- Chart.js èˆ‡æ’ä»¶ -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@1.1.0"></script>
  <style>
    /* åŸºæœ¬é‡ç½®èˆ‡ box-sizing */
    * { box-sizing: border-box; }
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      overflow-x: hidden;
      font-family: 'Roboto', sans-serif;
    }
    /* æ¡Œé¢ç‰ˆåƒ…å•Ÿç”¨å¿«é€Ÿæ»¾å‹• */
    @media (min-width: 769px) {
      body { overflow-y: hidden; }
    }
    :root {
      --bg-color: #f9f9f9;
      --text-color: #333;
      --container-bg: #fff;
      --primary-color: #3498db;
      --primary-hover: #2980b9;
      --table-border: #ddd;
      --shadow-light: rgba(0,0,0,0.1);
      --shadow-dark: rgba(0,0,0,0.2);
      --button-shadow: 0 3px 6px rgba(0,0,0,0.15);
      --bg-gradient-light: linear-gradient(-45deg, #ffffff, #e6f7ff, #ffffff, #e6f7ff);
    }
    .dark {
      --bg-color: #121212;
      --text-color: #ccc;
      --container-bg: #1e1e1e;
      --primary-color: #2980b9;
      --primary-hover: #1f6391;
      --table-border: #555;
      --shadow-light: rgba(0,0,0,0.2);
      --shadow-dark: rgba(0,0,0,0.4);
      --button-shadow: 0 5px 10px rgba(0,0,0,0.2);
      --bg-gradient-dark: linear-gradient(-45deg, #1c1c3c, #32325d, #1c1c3c, #32325d);
    }
    body {
      background: var(--bg-gradient-light);
      color: var(--text-color);
      transition: background 1s ease, color 1s ease;
    }
    body.dark {
      background: var(--bg-gradient-dark);
    }
    section {
      min-height: 100vh;
      padding: 1.25rem 0.625rem;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    .module {
      background: var(--container-bg);
      border-radius: 1rem;
      box-shadow: 0.5rem 0.5rem 1rem var(--shadow-light), -0.5rem -0.5rem 1rem var(--shadow-light);
      padding: 1.25rem 1.875rem;
      margin: 0.625rem auto;
      width: 90%;
      max-width: 56.25rem;
      transition: box-shadow 0.3s;
    }
    .module:hover {
      box-shadow: 0.625rem 0.625rem 1.25rem var(--shadow-dark), -0.625rem -0.625rem 1.25rem var(--shadow-dark);
    }
    .module h2 {
      text-align: center;
      margin-bottom: 1.25rem;
      font-size: 1.6rem;
    }
    /* æ¨¡å¼åˆ‡æ›å€ */
    .mode-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin-bottom: 1rem;
    }
    .mode-toggle {
      display: inline-block;
      padding: 0.625rem 1.25rem;
      border: 0.125rem solid var(--primary-color);
      border-radius: 0.5rem;
      cursor: pointer;
      font-size: 1.1rem;
      font-weight: bold;
      color: var(--primary-color);
      background: linear-gradient(45deg, #fff, #f0f0f0);
      transition: transform 0.3s ease, background 0.3s ease, color 0.3s ease;
    }
    body.dark .mode-toggle {
      background: #444;
      border-color: #444;
      color: #ccc;
    }
    body.dark .mode-toggle.active {
      background: #2980b9;
      border-color: #2980b9;
      color: #fff;
    }
    .mode-toggle:hover { transform: scale(1.1); }
    /* è¡¨æ ¼å€ */
    .table-container {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      justify-content: center;
      margin-top: 1.25rem;
    }
    .table-box { flex: 1 1 45%; max-width: 45%; margin-bottom: 1.25rem; }
    .table-responsive { width: 100%; overflow-x: auto; }
    table { width: 100%; border-collapse: collapse; }
    th, td {
      padding: 0.5rem 0.75rem;
      text-align: center;
      vertical-align: middle;
      border-bottom: 0.125rem solid var(--primary-color);
      font-size: 0.95rem;
    }
    th { background: var(--primary-color); color: #fff; }
    /* å´é‚Šé¸å–®ï¼ˆç„¡è«–è¡Œå‹•ç‰ˆæˆ–é›»è…¦ç‰ˆçš†ä½¿ç”¨åŒä¸€å€‹é–‹é—œï¼‰ */
    #sideMenu {
      position: fixed;
      top: 0;
      left: 0;
      width: 240px;
      height: 100%;
      background: rgba(255,255,255,0.7);
      backdrop-filter: blur(10px);
      box-shadow: 2px 0 8px rgba(0,0,0,0.1);
      transition: transform 0.3s ease, background 0.3s ease;
      z-index: 1300;
      padding: 1.5rem 1rem;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    /* é è¨­é–‹å•Ÿå´é‚Šæ¬„ */
    #sideMenu.collapsed { transform: translateX(-100%); }
    body.dark #sideMenu { background: rgba(34,34,34,0.7); backdrop-filter: blur(10px); }
    #sideMenu a {
      color: #333;
      text-decoration: none;
      font-size: 1.1rem;
      padding: 0.5rem 0.75rem;
      border-radius: 4px;
      transition: transform 0.3s ease, background 0.3s ease;
    }
    body.dark #sideMenu a { color: #ddd; }
    #sideMenu a.active, #sideMenu a:hover {
      background: #3498db;
      color: #fff;
      transform: scale(1.05);
    }
    body.dark #sideMenu a.active, body.dark #sideMenu a:hover {
      background: #2980b9;
      color: #fff;
    }
    /* ç¶²ç«™æ¨™é¡Œï¼ˆæ•´å€‹å®¹å™¨å¯é»æ“Šï¼‰ */
    #siteTitleContainer {
      text-align: center;
      margin-bottom: 1rem;
      user-select: none;
      cursor: pointer;
    }
    #siteTitleContainer:hover { transform: scale(1.02); }
    #siteTitleContainer h1 {
      margin: 0;
      font-size: 1.2rem;
      font-weight: bold;
    }
    #siteTitleSub {
      display: block;
      margin-top: 0.25rem;
      font-size: 1rem;
      color: var(--primary-color);
      font-weight: bold;
      user-select: none;
    }
    #siteTitleContainer:hover #siteTitleSub { text-shadow: 0 0 5px rgba(52,152,219,0.5); }
    #easterEggText {
      display: block;
      margin-top: 0.25rem;
      font-size: 1rem;
      font-weight: bold;
      color: var(--primary-color);
    }
    /* é»‘å¤œæ¨¡å¼ä¸‹ï¼Œèª¿æ•´èªè¨€é¸æ“‡ã€è¼¸å…¥æ¡†ã€è¨ˆç®—çµæœèƒŒæ™¯èˆ‡æ–‡å­— */
    body.dark select,
    body.dark input[type="text"] {
      background: #333;
      color: #fff;
      border-color: #555;
    }
    body.dark .result {
      background: #333;
      color: #fff;
    }
    /* é»‘ï¼ç™½æ¨¡å¼åˆ‡æ›æŒ‰éˆ• */
    #darkModeToggle {
      margin-top: auto;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem;
      border-top: 1px solid #ccc;
      transition: transform 0.3s ease;
    }
    #darkModeToggle:hover { transform: scale(1.05); }
    #darkModeToggle svg { width: 1.5rem; height: 1.5rem; }
    #darkModeToggle span { font-size: 1rem; color: #333; }
    body.dark #darkModeToggle span { color: #eee; }
    /* å´é‚Šé¸å–®é–‹é—œæŒ‰éˆ•ï¼ˆçµ±ä¸€ä½¿ç”¨åŒä¸€å€‹é–‹é—œï¼Œç½®ä¸­ç¬¦è™Ÿï¼‰ */
    #sideMenuToggle {
      position: fixed;
      top: 10px;
      left: 250px;
      background: rgba(255,255,255,0.7);
      backdrop-filter: blur(10px);
      color: #333;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      cursor: pointer;
      z-index: 1400;
      transition: left 0.3s ease, background 0.3s ease;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    body.dark #sideMenuToggle {
      background: rgba(34,34,34,0.7);
      color: #ddd;
    }
    #sideMenuToggle:hover { transform: scale(1.1); }
    /* ç§»é™¤è¡Œå‹•ç‰ˆå°ˆç”¨é–‹é—œï¼ˆçµ±ä¸€ä½¿ç”¨ sideMenuToggleï¼‰ */
    /* (åŸæœ¬çš„ bottomNav èˆ‡ menuOverlay å€å¡Šå¯åˆªé™¤) */

    /* æ›ç®—éç¨‹å€å¡Šï¼šä¸è‡ªå‹•å±•é–‹ï¼Œä¸¦æ”¹å–„æ’ç‰ˆ */
    #processBtn {
      background: var(--primary-hover);
      color: #fff;
      border: none;
      padding: 0.4rem 0.8rem;
      font-size: 0.9rem;
      border-radius: 0.5rem;
      cursor: pointer;
      margin-left: 0.5rem;
      transition: background 0.3s;
    }
    #processBtn:hover { background: var(--primary-color); }
    #processInfo {
      max-height: 0;
      overflow-y: auto;
      opacity: 0;
      transition: max-height 0.3s ease, opacity 0.3s ease;
      margin-top: 0.5rem;
      padding: 0 0.5rem;
      background: #fff;
      border-radius: 0.5rem;
      font-size: 0.9rem;
      white-space: pre-wrap;
      font-family: monospace;
      line-height: 1.5;
      position: relative;
      z-index: 500;
      color: #000;
      border: 0.125rem solid var(--table-border);
    }
    body.dark #processInfo {
      background: #333;
      color: #fff;
    }
    #processInfo.visible {
      max-height: 15rem;
      opacity: 1;
      padding: 0.5rem;
      padding-bottom: 3rem;
    }
    #processTopBtn {
      position: absolute;
      bottom: 0.5rem;
      right: 0.5rem;
      background: var(--primary-color);
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 2.5rem;
      height: 2.5rem;
      font-size: 1.3rem;
      font-weight: bold;
      cursor: pointer;
      transition: background 0.3s;
      z-index: 500;
    }
    #processTopBtn:hover { background: var(--primary-hover); }
    .result {
      margin-top: 1rem;
      padding: 0.75rem;
      background: #fff;
      border-radius: 0.5rem;
      text-align: left;
      font-size: 1.2rem;
      font-weight: bold;
      color: var(--primary-color);
      opacity: 0;
      transition: opacity 0.3s;
    }
    body.dark .result {
      background: #333;
      color: #fff;
    }
    .result.visible { opacity: 1; }
    /* åœ–è¡¨å€ */
    .chart-container {
      position: relative;
      margin: auto;
      height: 28rem;
      width: 100%;
    }
    /* åœ–è¡¨æ§åˆ¶å€ */
    #chartControls {
      text-align: center;
      margin-bottom: 1rem;
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      opacity: 0;
      animation: fadeIn 0.5s forwards;
    }
    #chartControls label {
      font-size: 1rem;
      color: var(--text-color);
      cursor: pointer;
    }
    /* æ›ç®—éç¨‹æ‰“å­—å‹•ç•«ï¼šé€å­—æ·¡å…¥ */
    #processInfo span.char {
      opacity: 0;
      transition: opacity 0.05s ease;
      position: relative;
      display: inline-block;
    }
    .blinker {
      position: absolute;
      bottom: -4px;
      right: -6px;
      font-size: 0.8em;
      animation: blink 1s ease-in-out infinite;
      z-index: 9999;
    }
    @keyframes blink {
      0%, 50%, 100% { opacity: 1; }
      25%, 75% { opacity: 0; }
    }
    /* åº•éƒ¨è£½ä½œè€…è³‡è¨Š */
    #hiddenCredits {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: #808080;
      color: #fff;
      text-align: center;
      padding: 0.75rem;
      box-shadow: 0 -0.25rem 0.75rem rgba(0,0,0,0.3);
      transform: translateY(100%);
      transition: transform 0.3s ease;
      z-index: 500;
      font-size: 1rem;
    }
    #hiddenCredits.visible { transform: translateY(0); }
    /* ç°¡å–® fadeIn å‹•ç•« */
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    /* å³ä¸‹è§’å°èˆªæŒ‰éˆ• */
    #pageNav {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      z-index: 1200;
    }
    #pageNav button {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      border: none;
      background: linear-gradient(135deg, #3498db, #2980b9);
      color: #fff;
      font-size: 1.8rem;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    #pageNav button:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 12px rgba(0,0,0,0.3);
    }
    #navPrev::before { content: "â–²"; }
    #navNext::before { content: "â–¼"; }
    #pageNav button.hidden {
      opacity: 0;
      transform: scale(0.5);
      pointer-events: none;
    }
    #pageNav button:active { transform: scale(1); }
    /* æŒ‰éˆ•åŸºæœ¬æ¨£å¼ */
    button {
      background: linear-gradient(45deg, var(--primary-color), var(--primary-hover));
      color: #fff;
      border: none;
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      border-radius: 0.75rem;
      cursor: pointer;
      margin: 0.625rem 0;
      transition: background 0.3s, transform 0.2s, box-shadow 0.3s;
      box-shadow: var(--button-shadow);
    }
    button:hover { 
      background: linear-gradient(45deg, var(--primary-hover), var(--primary-color));
      transform: translateY(-2px);
      box-shadow: 0 5px 10px rgba(0,0,0,0.2);
    }
    /* è¼¸å…¥æ¡†èˆ‡é¸æ“‡æ¡† */
    input[type="text"], select {
      padding: 0.5rem;
      border: 0.125rem solid var(--primary-color);
      border-radius: 0.5rem;
      font-size: 1.1rem;
      margin: 0.625rem 0;
      transition: border-color 0.3s, box-shadow 0.3s;
      background: #fff;
      color: #333;
    }
    input[type="text"]:focus, select:focus {
      outline: none;
      border-color: var(--primary-hover);
      box-shadow: 0 0 5px rgba(52,152,219,0.5);
    }
    /* è¡Œå‹•ç‰ˆï¼šèª¿æ•´è¨ˆç®—æŒ‰éˆ•èˆ‡è¼¸å…¥æ¡†åŒæ’ */
    @media (max-width: 768px) {
      #calculator > div[style] {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
      }
      #calculator input[type="text"] { flex: 1; }
      #calcBtn { margin-left: 0.5rem; }
    }
    /* CSS é«˜äº®å‹•ç•« */
    .highlight {
      animation: highlightAnim 1s forwards;
    }
    @keyframes highlightAnim {
      0% { box-shadow: 0 0 10px 5px yellow; }
      100% { box-shadow: none; }
    }
    .highlight-long {
      animation: highlightAnimLong 2s forwards;
    }
    @keyframes highlightAnimLong {
      0% { box-shadow: 0 0 15px 7px yellow; }
      100% { box-shadow: none; }
    }
  </style>
</head>
<body>
  <!-- ç§»é™¤åŸè¡Œå‹•ç‰ˆçš„ bottomNavï¼Œçµ±ä¸€ä½¿ç”¨ sideMenuToggle -->
  <!-- å´é‚Šé¸å–®é–‹é—œæŒ‰éˆ• -->
  <button id="sideMenuToggle" title="åˆ‡æ›é¸å–®">â˜°</button>
  <!-- å´é‚Šé¸å–® -->
  <div id="sideMenu">
    <!-- ç¶²ç«™æ¨™é¡Œï¼ˆæ•´å€‹å®¹å™¨å¯é»æ“Šï¼‰ -->
    <div id="siteTitleContainer">
      <h1 id="siteTitle">Random Dice Defense : PvP</h1>
      <span id="siteTitleSub"></span>
      <span id="easterEggText"></span>
    </div>
    <!-- èªè¨€åˆ‡æ›å€å¡Š -->
    <div id="languageToggle">
      <svg id="globeIcon" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 32 32" style="width:1.2rem; height:1.2rem;">
        <path d="M16 2.667C8.64 2.667 2.667 8.64 2.667 16S8.64 29.333 16 29.333 29.333 23.36 29.333 16 23.36 2.667 16 2.667zm0 24C9.76 26.667 4.667 21.573 4.667 16c0-5.573 5.093-10.667 11.333-10.667 6.24 0 11.333 5.093 11.333 10.667 0 5.573-5.093 10.667-11.333 10.667z"/>
        <path d="M14.667 4.76V27.24c-5.293-.64-9.333-5.107-9.333-11.24 0-6.133 5.093-10.6 9.333-11.24zM17.333 27.24V4.76c5.293.64 9.333 5.107 9.333 11.24 0 6.133-4.04 10.6-9.333 11.24z"/>
      </svg>
      <span>èªè¨€</span>
      <select id="langSelect" aria-label="é¸æ“‡èªè¨€">
        <option value="zh-TW">ç¹ä¸­</option>
        <option value="zh-CN">ç®€ä¸­</option>
        <option value="en">English</option>
        <option value="ja">æ—¥æœ¬èª</option>
        <option value="ko">í•œêµ­ì–´</option>
      </select>
    </div>
    <!-- å°è¦½é€£çµ -->
    <a href="#calculator" id="menuCalculator" data-target="calculator"></a>
    <a href="#common" id="menuCommon" data-target="common"></a>
    <a href="#chartSection" id="menuChartSection" data-target="chartSection"></a>
    <a href="#history" id="menuHistory" data-target="history"></a>
    <!-- é»‘ï¼ç™½æ¨¡å¼åˆ‡æ›æŒ‰éˆ• -->
    <div id="darkModeToggle">
      <svg id="darkModeIcon" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24"></svg>
      <span id="darkModeText"></span>
    </div>
  </div>
  <!-- ç§»é™¤åŸæœ¬è¡Œå‹•ç‰ˆçš„ menuOverlay èˆ‡ bottomNav -->

  <!-- å³ä¸‹è§’å°èˆªæŒ‰éˆ• -->
  <div id="pageNav">
    <button id="navTop" title="å›åˆ°é ‚éƒ¨" aria-label="å›åˆ°é ‚éƒ¨">â¥”</button>
    <button id="navPrev" title="ä¸Šä¸€é " aria-label="ä¸Šä¸€é "></button>
    <button id="navNext" title="ä¸‹ä¸€é " aria-label="ä¸‹ä¸€é "></button>
  </div>
  <!-- éš±è—çš„å›åˆ°é ‚éƒ¨ -->
  <div id="backToTop">â–²</div>
  <!-- æ›ç®—å™¨æ¨¡å¡Š -->
  <section id="calculator">
    <div class="module">
      <h2></h2>
      <div class="mode-container">
        <span class="mode-toggle active" id="btnR2C"></span>
        <span class="mode-toggle" id="btnC2R"></span>
        <button id="processBtn" title="" aria-label=""></button>
      </div>
      <div style="text-align: left; width: 100%;">
        <label for="inputValue"></label>
        <input type="text" id="inputValue" value="100" pattern="^[0-9]+$" inputmode="numeric">
        <button id="calcBtn"></button>
        <div class="result" id="result">â†’ </div>
        <div id="processInfo"></div>
      </div>
    </div>
  </section>
  <!-- å¸¸ç”¨æ›ç®—æ¨¡å¡Š -->
  <section id="common">
    <div class="module">
      <h2></h2>
      <div class="table-container">
        <div class="table-box">
          <h3></h3>
          <div class="table-responsive">
            <table id="r2cTable">
              <thead>
                <tr>
                  <th></th>
                  <th></th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
        <div class="table-box">
          <h3></h3>
          <div class="table-responsive">
            <table id="c2rTable">
              <thead>
                <tr>
                  <th></th>
                  <th></th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- é—œä¿‚åœ–æ¨¡å¡Š -->
  <section id="chartSection">
    <div class="module">
      <h2></h2>
      <div style="text-align: center; margin-bottom: 1rem;">
        <label for="chartType"></label>
        <select id="chartType" style="font-size: 1rem; padding: 0.25rem;">
          <option value="line"></option>
          <option value="bar"></option>
        </select>
      </div>
      <div id="chartControls">
        <label>
          <input type="checkbox" id="toggleAnnotations" checked>
          <span id="annotationsLabel"></span>
        </label>
        <label>
          <input type="checkbox" id="togglePoints" checked>
          <span id="pointsLabel"></span>
        </label>
        <label>
          <input type="checkbox" id="toggleGrid" checked>
          <span id="gridLabel"></span>
        </label>
      </div>
      <div class="chart-container">
        <canvas id="chart"></canvas>
      </div>
    </div>
  </section>
  <!-- æ›ç®—æ­·å²è¨˜éŒ„æ¨¡å¡Š -->
  <section id="history">
    <div class="module">
      <h2></h2>
      <button id="clearHistory"></button>
      <div class="table-responsive">
        <table id="historyTable">
          <thead>
            <tr>
              <th></th>
              <th></th>
              <th></th>
              <th></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      <div id="historyPagination" style="text-align: center; margin-top: 1rem;"></div>
    </div>
  </section>
  <!-- åº•éƒ¨è£½ä½œè€…è³‡è¨Š -->
  <div id="hiddenCredits"></div>
  <script>
    (function(){
      "use strict";
      //==============================
      // é…ç½®èˆ‡ LocalStorage éµå€¼
      //==============================
      const LS_KEYS = {
        darkMode: "converter_darkMode",
        lastInput: "converter_lastInput",
        mode: "converter_mode", // "r2c" æˆ– "c2r"
        history: "converter_history"
      };
      const CONFIG = {
        baseThreshold: 45,
        baseArray: [0,1,2,4,5],
        extraRanges: [
          {a: 46, b: 111, f: 1},
          {a: 112, b: 500, f: 2},
          {a: 501, b: 1000, f: 3},
          {a: 1001, b: 1500, f: 4},
          {a: 1501, b: Infinity, f: 5}
        ],
        chart: { maxRounds: 1600, step: 50 }
      };

      //==============================
      // ç¿»è­¯å­—å…¸è¨­å®š
      //==============================
      let currentLang = "zh-TW";
      const translations = {
        "zh-TW": {
          nav: {
             calculator: "æ›ç®—å™¨",
             common: "å¸¸ç”¨æ›ç®—",
             chartSection: "é—œä¿‚åœ–",
             history: "æ­·å²è¨˜éŒ„",
             closeMenu: "é—œé–‰é¸å–®"
          },
          calculator: {
             title: "å¡ç‰‡æ•¸ / å›åˆæ•¸ æ›ç®—å™¨",
             modeR2C: "å›åˆ â†’ å¡ç‰‡",
             modeC2R: "å¡ç‰‡ â†’ å›åˆ",
             inputLabel: "è¼¸å…¥æ•¸å­—ï¼š",
             calcBtn: "è¨ˆç®—",
             processBtn: "æ›ç®—éç¨‹",
             invalidInput: "è«‹è¼¸å…¥æœ‰æ•ˆä¸”å¤§æ–¼ 0 çš„æ•¸å€¼"
          },
          common: { title: "å¸¸ç”¨æ›ç®—", r2c: "å›åˆ â†’ å¡ç‰‡", c2r: "å¡ç‰‡ â†’ å›åˆ" },
          chart: {
             title: "å¡æ•¸ - å›åˆæ•¸ é—œä¿‚åœ–",
             chartTypeLabel: "åœ–è¡¨é¡å‹ï¼š",
             optionLine: "æŠ˜ç·šåœ–",
             optionBar: "æŸ±ç‹€åœ–",
             xAxis: "å›åˆæ•¸",
             yAxis: "å¡ç‰‡æ•¸",
             showAnnotationsLabel: "é¡¯ç¤ºæ¨™è¨»ç·š",
             showPointsLabel: "é¡¯ç¤ºè³‡æ–™é»",
             showGridLabel: "é¡¯ç¤ºç¶²æ ¼ç·š",
             roundSuffix: "å›"
          },
          history: { title: "æ›ç®—æ­·å²è¨˜éŒ„", clearHistory: "æ¸…é™¤æ­·å²", noRecord: "ç„¡æ­·å²è¨˜éŒ„" },
          process: {
             r2cTitle: "ã€å›åˆ â†’ å¡ç‰‡ æ›ç®—éç¨‹ã€‘",
             c2rTitle: "ã€å¡ç‰‡ â†’ å›åˆ æ›ç®—éç¨‹ã€‘",
             r2cStep1: "1. å‰45å›éƒ¨åˆ†ï¼š",
             r2cLine1: "   - å›åˆæ•¸ï¼šmin({input}, 45) = {r}",
             r2cLine2: "   - åŸºç¤å¡ç‰‡ = floor({r}/5) * 8 = {baseCalc}",
             r2cLine3: "   - é¤˜æ•¸ {mod} â†’ åŠ æˆ {lookup} å¡",
             r2cLine4: "   â†’ å°è¨ˆ = {subtotal}",
             r2cStep2: "2. è¶…é45å›éƒ¨åˆ†ï¼š",
             r2cLineExtra: "   - å€é–“ {a}ï½{b} (å€ç‡ {f})ï¼šè¨ˆç®—å¾— {extra}",
             r2cStep3: "3. ç¸½å¡ç‰‡æ•¸ = åŸºç¤ ({subtotal}) + è¶…ééƒ¨åˆ† ({extraTotal}) = {result} å¡",
             c2rStep1: "1. åˆ©ç”¨äºŒåˆ†æœå°‹æ³•å°‹æ‰¾æœ€å°å›åˆæ•¸ï¼Œä½¿æ›ç®—å¾Œå¡ç‰‡æ•¸ â‰¥ è¼¸å…¥å¡ç‰‡æ•¸ã€‚",
             c2rStep2: "   - åˆå§‹ç¯„åœï¼šä½ = 1, é«˜ = {high}",
             c2rStep3: "   - è¿­ä»£ï¼šå›åˆæ•¸ {mid} â†’ {cards} å¡",
             c2rStep4: "   â†’ çµæœï¼šæœ€å°å›åˆæ•¸ = {result}"
          },
          tables: {
            r2c: { header1: "å›åˆæ•¸", header2: "å¡ç‰‡æ•¸" },
            c2r: { header1: "å¡ç‰‡æ•¸", header2: "å›åˆæ•¸" },
            history: { header1: "æ™‚é–“", header2: "æ¨¡å¼", header3: "è¼¸å…¥å€¼", header4: "çµæœ" }
          },
          units: { r2c: " å¡ç‰‡", c2r: " å›åˆ" },
          pagination: { prev: "ä¸Šä¸€é ", next: "ä¸‹ä¸€é ", pageInfo: "ç¬¬ {current} é  / å…± {total} é " },
          credits: "ç¶²é ã€åœ–è¡¨è£½ä½œï¼šDiscord ğ•«ğ•™ğ•šğ•ğ•š @zhili_71",
          darkMode: { light: "ç™½å¤©æ¨¡å¼", dark: "é»‘å¤œæ¨¡å¼" },
          siteTitleSub: "å”åŒæ¨¡å¼å¡ç‰‡è¨ˆç®—å™¨",
          easterEgg: {
            click1: "ThinkingğŸ¤”",
            click3: "é›™å€ ThinkingğŸ¤”",
            click5: "ä¸‰å€ ThinkingğŸ¤”ï¼",
            click7: "ä¸»å®°ä¸€åˆ‡ï¼",
            click10: "ç‹‚æš´æ”»æ“Šï¼ï¼",
            click15: "çµ‚æ¥µ ThinkingğŸ¤”ï¼ï¼",
            click25: "ç„¡äººèƒ½æ“‹ï¼ï¼",
            click35: "è®Šæ…‹æ®ºæˆ®ï¼ï¼",
            click45: "çŒ›ç¸ç´š ThinkingğŸ¤”ï¼ï¼ï¼",
            click60: "è¶…ç¥çš„ï¼ï¼ï¼ï¼",
            click80: "æ¯”ç¥é‚„ç¥ï¼ï¼ï¼ï¼"
          }
        },
        "zh-CN": {
          nav: {
             calculator: "æ¢ç®—å™¨",
             common: "å¸¸ç”¨æ¢ç®—",
             chartSection: "å…³ç³»å›¾",
             history: "å†å²è®°å½•",
             closeMenu: "å…³é—­é€‰å•"
          },
          calculator: {
             title: "å¡ç‰‡æ•° / å›åˆæ•° æ¢ç®—å™¨",
             modeR2C: "å›åˆ â†’ å¡ç‰‡",
             modeC2R: "å¡ç‰‡ â†’ å›åˆ",
             inputLabel: "è¾“å…¥æ•°å­—ï¼š",
             calcBtn: "è®¡ç®—",
             processBtn: "æ¢ç®—è¿‡ç¨‹",
             invalidInput: "è¯·è¾“å…¥æœ‰æ•ˆä¸”å¤§äº 0 çš„æ•°å€¼"
          },
          common: { title: "å¸¸ç”¨æ¢ç®—", r2c: "å›åˆ â†’ å¡ç‰‡", c2r: "å¡ç‰‡ â†’ å›åˆ" },
          chart: {
             title: "å¡æ•° - å›åˆæ•° å…³ç³»å›¾",
             chartTypeLabel: "å›¾è¡¨ç±»å‹ï¼š",
             optionLine: "æŠ˜çº¿å›¾",
             optionBar: "æŸ±çŠ¶å›¾",
             xAxis: "å›åˆæ•°",
             yAxis: "å¡ç‰‡æ•°",
             showAnnotationsLabel: "æ˜¾ç¤ºæ ‡æ³¨çº¿",
             showPointsLabel: "æ˜¾ç¤ºæ•°æ®ç‚¹",
             showGridLabel: "æ˜¾ç¤ºç½‘æ ¼çº¿",
             roundSuffix: "å›"
          },
          history: { title: "æ¢ç®—å†å²è®°å½•", clearHistory: "æ¸…é™¤å†å²", noRecord: "æ— å†å²è®°å½•" },
          process: {
             r2cTitle: "ã€å›åˆ â†’ å¡ç‰‡ æ¢ç®—è¿‡ç¨‹ã€‘",
             c2rTitle: "ã€å¡ç‰‡ â†’ å›åˆ æ¢ç®—è¿‡ç¨‹ã€‘",
             r2cStep1: "1. å‰45å›éƒ¨åˆ†ï¼š",
             r2cLine1: "   - å›åˆæ•°ï¼šmin({input}, 45) = {r}",
             r2cLine2: "   - åŸºç¡€å¡ç‰‡ = floor({r}/5) * 8 = {baseCalc}",
             r2cLine3: "   - ä½™æ•° {mod} â†’ åŠ æˆ {lookup} å¡",
             r2cLine4: "   â†’ å°è®¡ = {subtotal}",
             r2cStep2: "2. è¶…è¿‡45å›éƒ¨åˆ†ï¼š",
             r2cLineExtra: "   - åŒºé—´ {a}ï½{b} (å€ç‡ {f})ï¼šè®¡ç®—å¾— {extra}",
             r2cStep3: "3. æ€»å¡ç‰‡æ•° = åŸºç¡€ ({subtotal}) + è¶…è¿‡éƒ¨åˆ† ({extraTotal}) = {result} å¡",
             c2rStep1: "1. åˆ©ç”¨äºŒåˆ†æœç´¢æ³•å¯»æ‰¾æœ€å°å›åˆæ•°ï¼Œä½¿æ¢ç®—åå¡ç‰‡æ•° â‰¥ è¾“å…¥å¡ç‰‡æ•°ã€‚",
             c2rStep2: "   - åˆå§‹èŒƒå›´ï¼šä½ = 1, é«˜ = {high}",
             c2rStep3: "   - è¿­ä»£ï¼šå›åˆæ•° {mid} â†’ {cards} å¡",
             c2rStep4: "   â†’ ç»“æœï¼šæœ€å°å›åˆæ•° = {result}"
          },
          tables: {
            r2c: { header1: "å›åˆæ•°", header2: "å¡ç‰‡æ•°" },
            c2r: { header1: "å¡ç‰‡æ•°", header2: "å›åˆæ•°" },
            history: { header1: "æ—¶é—´", header2: "æ¨¡å¼", header3: "è¾“å…¥å€¼", header4: "ç»“æœ" }
          },
          units: { r2c: " å¡ç‰‡", c2r: " å›åˆ" },
          pagination: { prev: "ä¸Šä¸€é¡µ", next: "ä¸‹ä¸€é¡µ", pageInfo: "ç¬¬ {current} é¡µ / å…± {total} é¡µ" },
          credits: "ç½‘é¡µã€å›¾è¡¨åˆ¶ä½œï¼šDiscord ğ•«ğ•™ğ•šğ•ğ•š @zhili_71",
          darkMode: { light: "ç™½å¤©æ¨¡å¼", dark: "é»‘å¤œæ¨¡å¼" },
          siteTitleSub: "ååŒæ¨¡å¼å¡ç‰‡è®¡ç®—å™¨",
          easterEgg: {
            click1: "ThinkingğŸ¤”",
            click3: "åŒå€ ThinkingğŸ¤”",
            click5: "ä¸‰å€ ThinkingğŸ¤”ï¼",
            click7: "ä¸»å®°ä¸€åˆ‡ï¼",
            click10: "ç‹‚æš´æ”»å‡»ï¼ï¼",
            click15: "ç»ˆæ ThinkingğŸ¤”ï¼ï¼",
            click25: "æ— äººèƒ½æŒ¡ï¼ï¼",
            click35: "å˜æ€æ€æˆ®ï¼ï¼",
            click45: "çŒ›å…½çº§ ThinkingğŸ¤”ï¼ï¼ï¼",
            click60: "è¶…ç¥çš„ï¼ï¼ï¼ï¼",
            click80: "æ¯”ç¥è¿˜ç¥ï¼ï¼ï¼ï¼"
          }
        },
        "en": {
          nav: {
             calculator: "Calculator",
             common: "Common Conversions",
             chartSection: "Chart",
             history: "History",
             closeMenu: "Close Menu"
          },
          calculator: {
             title: "Card/Turn Converter",
             modeR2C: "Turn â†’ Card",
             modeC2R: "Card â†’ Turn",
             inputLabel: "Enter number:",
             calcBtn: "Calculate",
             processBtn: "Calculation Process",
             invalidInput: "Please enter a valid number greater than 0"
          },
          common: { title: "Common Conversions", r2c: "Turn â†’ Card", c2r: "Card â†’ Turn" },
          chart: {
             title: "Card - Turn Chart",
             chartTypeLabel: "Chart Type:",
             optionLine: "Line Chart",
             optionBar: "Bar Chart",
             xAxis: "Turn",
             yAxis: "Card",
             showAnnotationsLabel: "Show Annotations",
             showPointsLabel: "Show Data Points",
             showGridLabel: "Show Grid Lines",
             roundSuffix: " round"
          },
          history: { title: "Calculation History", clearHistory: "Clear History", noRecord: "No history record" },
          process: {
             r2cTitle: "[Turn â†’ Card Calculation Process]",
             c2rTitle: "[Card â†’ Turn Calculation Process]",
             r2cStep1: "1. For the first 45 turns:",
             r2cLine1: "   - Turns: min({input}, 45) = {r}",
             r2cLine2: "   - Base cards = floor({r}/5) * 8 = {baseCalc}",
             r2cLine3: "   - Remainder {mod} â†’ Bonus {lookup} cards",
             r2cLine4: "   â†’ Subtotal = {subtotal}",
             r2cStep2: "2. Beyond 45 turns:",
             r2cLineExtra: "   - Interval {a}â€“{b} (multiplier {f}): calculated {extra}",
             r2cStep3: "3. Total cards = Base ({subtotal}) + Extra ({extraTotal}) = {result} cards",
             c2rStep1: "1. Use binary search to find the minimum turn so that the converted cards â‰¥ input.",
             c2rStep2: "   - Initial range: low = 1, high = {high}",
             c2rStep3: "   - Iteration: Turn {mid} â†’ {cards} cards",
             c2rStep4: "   â†’ Result: Minimum turn = {result}"
          },
          tables: {
            r2c: { header1: "Turn", header2: "Card" },
            c2r: { header1: "Card", header2: "Turn" },
            history: { header1: "Time", header2: "Mode", header3: "Input", header4: "Result" }
          },
          units: { r2c: " Card", c2r: " Turn" },
          pagination: { prev: "Previous", next: "Next", pageInfo: "Page {current} of {total}" },
          credits: "Website and Chart by: Discord Zhili @zhili_71",
          darkMode: { light: "Day Mode", dark: "Night Mode" },
          siteTitleSub: "Co-op Mode Card Calculator",
          easterEgg: {
            click1: "Thinking ğŸ¤”",
            click3: "Double Thinking ğŸ¤”",
            click5: "Triple Thinking ğŸ¤”!",
            click7: "Rule Everything!",
            click10: "Frenzied Attack!!",
            click15: "Ultimate Thinking ğŸ¤”!!",
            click25: "Unstoppable!!",
            click35: "Insane Slaughter!!",
            click45: "Beast Mode Thinking ğŸ¤”!!!",
            click60: "Godlike!!!!",
            click80: "Beyond Godlike!!!!"
          }
        },
        "ja": {
          nav: {
             calculator: "è¨ˆç®—æ©Ÿ",
             common: "ä¸€èˆ¬æ›ç®—",
             chartSection: "ãƒãƒ£ãƒ¼ãƒˆ",
             history: "å±¥æ­´",
             closeMenu: "ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‰ã˜ã‚‹"
          },
          calculator: {
             title: "ã‚«ãƒ¼ãƒ‰ï¼ã‚¿ãƒ¼ãƒ³æ›ç®—å™¨",
             modeR2C: "ã‚¿ãƒ¼ãƒ³ â†’ ã‚«ãƒ¼ãƒ‰",
             modeC2R: "ã‚«ãƒ¼ãƒ‰ â†’ ã‚¿ãƒ¼ãƒ³",
             inputLabel: "æ•°å­—ã‚’å…¥åŠ›ï¼š",
             calcBtn: "è¨ˆç®—",
             processBtn: "è¨ˆç®—éç¨‹",
             invalidInput: "æœ‰åŠ¹ãª0ã‚ˆã‚Šå¤§ãã„æ•°å­—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
          },
          common: { title: "ä¸€èˆ¬æ›ç®—", r2c: "ã‚¿ãƒ¼ãƒ³ â†’ ã‚«ãƒ¼ãƒ‰", c2r: "ã‚«ãƒ¼ãƒ‰ â†’ ã‚¿ãƒ¼ãƒ³" },
          chart: {
             title: "ã‚«ãƒ¼ãƒ‰ - ã‚¿ãƒ¼ãƒ³ãƒãƒ£ãƒ¼ãƒˆ",
             chartTypeLabel: "ãƒãƒ£ãƒ¼ãƒˆã‚¿ã‚¤ãƒ—ï¼š",
             optionLine: "æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•",
             optionBar: "æ£’ã‚°ãƒ©ãƒ•",
             xAxis: "ã‚¿ãƒ¼ãƒ³æ•°",
             yAxis: "ã‚«ãƒ¼ãƒ‰æ•°",
             showAnnotationsLabel: "æ³¨é‡ˆã‚’è¡¨ç¤º",
             showPointsLabel: "ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã‚’è¡¨ç¤º",
             showGridLabel: "ã‚°ãƒªãƒƒãƒ‰ç·šã‚’è¡¨ç¤º",
             roundSuffix: "å›"
          },
          history: { title: "æ›ç®—å±¥æ­´", clearHistory: "å±¥æ­´ã‚’ã‚¯ãƒªã‚¢", noRecord: "å±¥æ­´ãªã—" },
          process: {
             r2cTitle: "ã€ã‚¿ãƒ¼ãƒ³ â†’ ã‚«ãƒ¼ãƒ‰ æ›ç®—éç¨‹ã€‘",
             c2rTitle: "ã€ã‚«ãƒ¼ãƒ‰ â†’ ã‚¿ãƒ¼ãƒ³ æ›ç®—éç¨‹ã€‘",
             r2cStep1: "1. æœ€åˆã®45ã‚¿ãƒ¼ãƒ³ï¼š",
             r2cLine1: "   - ã‚¿ãƒ¼ãƒ³æ•°ï¼šmin({input}, 45) = {r}",
             r2cLine2: "   - åŸºæœ¬ã‚«ãƒ¼ãƒ‰ = floor({r}/5) * 8 = {baseCalc}",
             r2cLine3: "   - ä½™ã‚Š {mod} â†’ ãƒœãƒ¼ãƒŠã‚¹ {lookup} ã‚«ãƒ¼ãƒ‰",
             r2cLine4: "   â†’ å°è¨ˆ = {subtotal}",
             r2cStep2: "2. 45ã‚¿ãƒ¼ãƒ³è¶…éåˆ†ï¼š",
             r2cLineExtra: "   - ç¯„å›² {a}ï½{b} (å€ç‡ {f})ï¼š{extra} æš",
             r2cStep3: "3. åˆè¨ˆã‚«ãƒ¼ãƒ‰ = åŸºæœ¬ ({subtotal}) + è¶…éåˆ† ({extraTotal}) = {result} æš",
             c2rStep1: "1. äºŒåˆ†æ¢ç´¢ã§æœ€å°ã‚¿ãƒ¼ãƒ³æ•°ã‚’æ±‚ã‚ã‚‹ï¼šã‚«ãƒ¼ãƒ‰æ•° â‰¥ å…¥åŠ›å€¤ã€‚",
             c2rStep2: "   - åˆæœŸç¯„å›²ï¼šä½ = 1, é«˜ = {high}",
             c2rStep3: "   - åå¾©ï¼šã‚¿ãƒ¼ãƒ³ {mid} â†’ {cards} æš",
             c2rStep4: "   â†’ çµæœï¼šæœ€å°ã‚¿ãƒ¼ãƒ³æ•° = {result}"
          },
          tables: {
            r2c: { header1: "ã‚¿ãƒ¼ãƒ³æ•°", header2: "ã‚«ãƒ¼ãƒ‰æ•°" },
            c2r: { header1: "ã‚«ãƒ¼ãƒ‰æ•°", header2: "ã‚¿ãƒ¼ãƒ³æ•°" },
            history: { header1: "æ™‚é–“", header2: "ãƒ¢ãƒ¼ãƒ‰", header3: "å…¥åŠ›å€¤", header4: "çµæœ" }
          },
          units: { r2c: " æš", c2r: " ã‚¿ãƒ¼ãƒ³" },
          pagination: { prev: "å‰ã¸", next: "æ¬¡ã¸", pageInfo: "ãƒšãƒ¼ã‚¸ {current} / {total}ãƒšãƒ¼ã‚¸" },
          credits: "ã‚¦ã‚§ãƒ–ã€ãƒãƒ£ãƒ¼ãƒˆåˆ¶ä½œï¼šDiscord Zhili @zhili_71",
          darkMode: { light: "æ˜¼ãƒ¢ãƒ¼ãƒ‰", dark: "å¤œãƒ¢ãƒ¼ãƒ‰" },
          siteTitleSub: "å”åŒæ¨¡å¼å¡ç‰‡è¨ˆç®—æ©Ÿ",
          easterEgg: {
            click1: "ThinkingğŸ¤”",
            click3: "ãƒ€ãƒ–ãƒ« ThinkingğŸ¤”",
            click5: "ãƒˆãƒªãƒ—ãƒ« ThinkingğŸ¤”ï¼",
            click7: "å…¨ã¦ã‚’æ”¯é…ï¼",
            click10: "çŒ›æ”»æ’ƒï¼ï¼",
            click15: "ç©¶æ¥µã® ThinkingğŸ¤”ï¼ï¼",
            click25: "èª°ã‚‚æ­¢ã‚ã‚‰ã‚Œãªã„ï¼ï¼",
            click35: "å¤‰æ…‹æ®ºæˆ®ï¼ï¼",
            click45: "çŒ›ç£ç´š ThinkingğŸ¤”ï¼ï¼ï¼",
            click60: "è¶…ç¥çš„ï¼ï¼ï¼ï¼",
            click80: "ç¥ã‚’è¶…ãˆã‚‹ï¼ï¼ï¼ï¼"
          }
        },
        "ko": {
          nav: {
             calculator: "ê³„ì‚°ê¸°",
             common: "ì¼ë°˜ ë³€í™˜",
             chartSection: "ì°¨íŠ¸",
             history: "ê¸°ë¡",
             closeMenu: "ë©”ë‰´ ë‹«ê¸°"
          },
          calculator: {
             title: "ì¹´ë“œ/í„´ ë³€í™˜ê¸°",
             modeR2C: "í„´ â†’ ì¹´ë“œ",
             modeC2R: "ì¹´ë“œ â†’ í„´",
             inputLabel: "ìˆ«ì ì…ë ¥:",
             calcBtn: "ê³„ì‚°",
             processBtn: "ê³„ì‚° ê³¼ì •",
             invalidInput: "ìœ íš¨í•˜ê³  0ë³´ë‹¤ í° ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”"
          },
          common: { title: "ì¼ë°˜ ë³€í™˜", r2c: "í„´ â†’ ì¹´ë“œ", c2r: "ì¹´ë“œ â†’ í„´" },
          chart: {
             title: "ì¹´ë“œ - í„´ ì°¨íŠ¸",
             chartTypeLabel: "ì°¨íŠ¸ ìœ í˜•:",
             optionLine: "ì„  ê·¸ë˜í”„",
             optionBar: "ë§‰ëŒ€ ê·¸ë˜í”„",
             xAxis: "í„´ ìˆ˜",
             yAxis: "ì¹´ë“œ ìˆ˜",
             showAnnotationsLabel: "ì£¼ì„ í‘œì‹œ",
             showPointsLabel: "ë°ì´í„° í¬ì¸íŠ¸ í‘œì‹œ",
             showGridLabel: "ê·¸ë¦¬ë“œ ì„  í‘œì‹œ",
             roundSuffix: "íšŒ"
          },
          history: { title: "ë³€í™˜ ê¸°ë¡", clearHistory: "ê¸°ë¡ ì‚­ì œ", noRecord: "ê¸°ë¡ ì—†ìŒ" },
          process: {
             r2cTitle: "ã€í„´ â†’ ì¹´ë“œ ë³€í™˜ ê³¼ì •ã€‘",
             c2rTitle: "ã€ì¹´ë“œ â†’ í„´ ë³€í™˜ ê³¼ì •ã€‘",
             r2cStep1: "1. ì²˜ìŒ 45í„´:",
             r2cLine1: "   - í„´ ìˆ˜: min({input}, 45) = {r}",
             r2cLine2: "   - ê¸°ë³¸ ì¹´ë“œ = floor({r}/5) * 8 = {baseCalc}",
             r2cLine3: "   - ë‚˜ë¨¸ì§€ {mod} â†’ ë³´ë„ˆìŠ¤ {lookup} ì¹´ë“œ",
             r2cLine4: "   â†’ ì†Œê³„ = {subtotal}",
             r2cStep2: "2. 45í„´ ì´ˆê³¼:",
             r2cLineExtra: "   - êµ¬ê°„ {a}â€“{b} (ë°°ìœ¨ {f}): {extra} ì¥",
             r2cStep3: "3. ì´ ì¹´ë“œ = ê¸°ë³¸ ({subtotal}) + ì´ˆê³¼ ({extraTotal}) = {result} ì¥",
             c2rStep1: "1. ì´ë¶„ íƒìƒ‰ìœ¼ë¡œ ìµœì†Œ í„´ ìˆ˜ ì°¾ê¸°:",
             c2rStep2: "   - ì´ˆê¸° ë²”ìœ„: ë‚®ìŒ = 1, ë†’ìŒ = {high}",
             c2rStep3: "   - ë°˜ë³µ: í„´ {mid} â†’ {cards} ì¥",
             c2rStep4: "   â†’ ê²°ê³¼: ìµœì†Œ í„´ ìˆ˜ = {result}"
          },
          tables: {
            r2c: { header1: "í„´ ìˆ˜", header2: "ì¹´ë“œ ìˆ˜" },
            c2r: { header1: "ì¹´ë“œ ìˆ˜", header2: "í„´ ìˆ˜" },
            history: { header1: "ì‹œê°„", header2: "ëª¨ë“œ", header3: "ì…ë ¥ê°’", header4: "ê²°ê³¼" }
          },
          units: { r2c: " ì¥", c2r: " í„´" },
          pagination: { prev: "ì´ì „", next: "ë‹¤ìŒ", pageInfo: "í˜ì´ì§€ {current} / {total}í˜ì´ì§€" },
          credits: "ì›¹, ì°¨íŠ¸ ì œì‘: Discord Zhili @zhili_71",
          darkMode: { light: "ì£¼ê°„ëª¨ë“œ", dark: "ì•¼ê°„ëª¨ë“œ" },
          siteTitleSub: "í˜‘ë™ ëª¨ë“œ ì¹´ë“œ ê³„ì‚°ê¸°",
          easterEgg: {
            click1: "ThinkingğŸ¤”",
            click3: "ë”ë¸” ThinkingğŸ¤”",
            click5: "íŠ¸ë¦¬í”Œ ThinkingğŸ¤”!",
            click7: "ëª¨ë“  ê±¸ ì§€ë°°í•œë‹¤!",
            click10: "ê´‘í­ ê³µê²©!!",
            click15: "ê¶ê·¹ì˜ ThinkingğŸ¤”!!",
            click25: "ë§‰ì„ ì ì—†ë‹¤!!",
            click35: "ë³€íƒœ í•™ì‚´!!",
            click45: "ì•¼ìˆ˜ê¸‰ ThinkingğŸ¤”!!!",
            click60: "ì´ˆì‹ ì˜!!!!",
            click80: "ì‹ ë³´ë‹¤ ì‹ !!!!"
          }
        }
      };

      // æ ¹æ“šèªç³»å‚³å› locale å­—ä¸²
      function getLocale(lang) {
        switch(lang) {
          case "zh-TW": return "zh-TW";
          case "zh-CN": return "zh-CN";
          case "en": return "en-US";
          case "ja": return "ja-JP";
          case "ko": return "ko-KR";
          default: return lang;
        }
      }

      //==============================
      // DOM å…ƒç´ 
      //==============================
      const body = document.body;
      const inputValueElem = document.getElementById("inputValue");
      const resultDiv = document.getElementById("result");
      const processInfo = document.getElementById("processInfo");
      const btnR2C = document.getElementById("btnR2C");
      const btnC2R = document.getElementById("btnC2R");
      const calcBtn = document.getElementById("calcBtn");
      const processBtn = document.getElementById("processBtn");
      const chartTypeSelect = document.getElementById("chartType");
      const toggleAnnotationsCheckbox = document.getElementById("toggleAnnotations");
      const togglePointsCheckbox = document.getElementById("togglePoints");
      const toggleGridCheckbox = document.getElementById("toggleGrid");
      const r2cTableBody = document.getElementById("r2cTable").querySelector("tbody");
      const c2rTableBody = document.getElementById("c2rTable").querySelector("tbody");
      const historyTableBody = document.getElementById("historyTable").querySelector("tbody");
      const clearHistoryBtn = document.getElementById("clearHistory");
      const navTopBtn = document.getElementById("navTop");
      const navPrevBtn = document.getElementById("navPrev");
      const navNextBtn = document.getElementById("navNext");
      const historyPagination = document.getElementById("historyPagination");
      const darkModeToggle = document.getElementById("darkModeToggle");
      const darkModeIcon = document.getElementById("darkModeIcon");
      const darkModeText = document.getElementById("darkModeText");
      const langSelect = document.getElementById("langSelect");
      const sideMenuToggle = document.getElementById("sideMenuToggle");
      const siteTitleContainer = document.getElementById("siteTitleContainer");
      const siteTitle = document.getElementById("siteTitle");
      const siteTitleSub = document.getElementById("siteTitleSub");
      const easterEggText = document.getElementById("easterEggText");
      let myChart = null;
      let currentChartType = chartTypeSelect.value;
      let mode = "r2c";
      let historyData = [];
      let currentHistoryPage = 0;
      const recordsPerPage = 5;
      // æ‰“å­—å‹•ç•«ç›¸é—œè®Šæ•¸
      let typewriterInterval = null;
      let typewriterIndex = 0;
      let processTextCache = "";
      // å½©è›‹è¨ˆæ•¸åŠé‡ç½®è¨ˆæ™‚å™¨
      let eggClickCount = 0;
      let eggTimeout = null;

      //==============================
      // é™åˆ¶è¼¸å…¥æ¡†åƒ…æ¥å—æ•¸å­—
      //==============================
      inputValueElem.addEventListener("input", function(){
        this.value = this.value.replace(/\D/g, "");
      });

      //==============================
      // å„²å­˜èˆ‡è®€å– LocalStorage
      //==============================
      function saveLS(key, value) {
        localStorage.setItem(key, JSON.stringify(value));
      }
      function loadLS(key, defaultValue) {
        const val = localStorage.getItem(key);
        return val ? JSON.parse(val) : defaultValue;
      }

      //==============================
      // åˆå§‹åŒ–åå¥½èˆ‡æ­·å²è¨˜éŒ„
      //==============================
      function initPreferences(){
        const darkPref = loadLS(LS_KEYS.darkMode, null);
        if(darkPref !== null){
          if(darkPref) body.classList.add("dark");
          else body.classList.remove("dark");
        } else if(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches){
          body.classList.add("dark");
        }
        renderToggleBtn();
        const lastInput = loadLS(LS_KEYS.lastInput, "100");
        inputValueElem.value = lastInput;
        mode = loadLS(LS_KEYS.mode, "r2c");
        if(mode === "r2c"){
          btnR2C.classList.add("active");
          btnC2R.classList.remove("active");
        } else {
          btnC2R.classList.add("active");
          btnR2C.classList.remove("active");
        }
        historyData = loadLS(LS_KEYS.history, []);
        renderHistory();
        updateLanguage();
      }

      //==============================
      // å´é‚Šé¸å–®é–‹é—œåŠŸèƒ½ï¼ˆçµ±ä¸€ä½¿ç”¨ sideMenuToggleï¼‰
      //==============================
      sideMenuToggle.addEventListener("click", function(){
        sideMenu.classList.toggle("collapsed");
        if(sideMenu.classList.contains("collapsed")){
          sideMenuToggle.style.left = "0px";
        } else {
          sideMenuToggle.style.left = "250px";
        }
      });

      //==============================
      // Dark æ¨¡å¼åˆ‡æ›
      //==============================
      function renderToggleBtn(){
        if(body.classList.contains("dark")){
          darkModeIcon.innerHTML = getSunSVG();
          darkModeText.textContent = translations[currentLang].darkMode.light;
        } else {
          darkModeIcon.innerHTML = getMoonSVG();
          darkModeText.textContent = translations[currentLang].darkMode.dark;
        }
        updateChartAxisColor();
      }
      function getSunSVG(){
        return `<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
          <circle cx="12" cy="12" r="5"/>
          <line x1="12" y1="1" x2="12" y2="3" stroke="currentColor" stroke-width="2"/>
          <line x1="12" y1="21" x2="12" y2="23" stroke="currentColor" stroke-width="2"/>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" stroke="currentColor" stroke-width="2"/>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" stroke="currentColor" stroke-width="2"/>
          <line x1="1" y1="12" x2="3" y2="12" stroke="currentColor" stroke-width="2"/>
          <line x1="21" y1="12" x2="23" y2="12" stroke="currentColor" stroke-width="2"/>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" stroke="currentColor" stroke-width="2"/>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" stroke="currentColor" stroke-width="2"/>
        </svg>`;
      }
      function getMoonSVG(){
        return `<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
          <path d="M9.37 5.51A7 7 0 0 0 12 19a7 7 0 0 0 6.49-9.64A9 9 0 1 1 9.37 5.51z"/>
        </svg>`;
      }
      darkModeToggle.addEventListener("click", function(){
        body.classList.toggle("dark");
        renderToggleBtn();
        saveLS(LS_KEYS.darkMode, body.classList.contains("dark"));
      });

      //==============================
      // æ¡Œé¢ç‰ˆå¿«é€Ÿæ»¾å‹•ï¼ˆç¦ç”¨ä¸€èˆ¬æ»¾å‹•ï¼‰
      //==============================
      if(window.innerWidth > 768) {
        window.addEventListener("wheel", function(e) {
          e.preventDefault();
          if(e.deltaY > 0) {
            const sections = Array.from(document.querySelectorAll("section"));
            const currentScroll = window.scrollY;
            let target = null;
            for(let i = 0; i < sections.length; i++){
              if(sections[i].offsetTop > currentScroll + 50){
                target = sections[i];
                break;
              }
            }
            if(target) target.scrollIntoView({ behavior: "smooth" });
          } else {
            const sections = Array.from(document.querySelectorAll("section"));
            const currentScroll = window.scrollY;
            let target = null;
            for(let i = sections.length - 1; i >= 0; i--){
              if(sections[i].offsetTop < currentScroll - 50){
                target = sections[i];
                break;
              }
            }
            if(target) target.scrollIntoView({ behavior: "smooth" });
          }
        }, {passive: false});
      }

      //==============================
      // æ¡Œé¢ç‰ˆé é¢å°èˆªæŒ‰éˆ•
      //==============================
      let ticking = false;
      window.addEventListener("scroll", function(){
        if (!ticking) {
          window.requestAnimationFrame(function(){
            if(window.innerHeight + window.scrollY >= document.body.offsetHeight - 150){
              document.getElementById("hiddenCredits").classList.add("visible");
            } else {
              document.getElementById("hiddenCredits").classList.remove("visible");
            }
            updateSideMenuHighlight();
            ticking = false;
          });
          ticking = true;
        }
      });
      navTopBtn.addEventListener("click", function(){
        window.scrollTo({ top: 0, behavior: "smooth" });
      });
      navPrevBtn.addEventListener("click", function(){
        const sections = Array.from(document.querySelectorAll("section"));
        const currentScroll = window.scrollY;
        let target = null;
        for(let i = sections.length - 1; i >= 0; i--){
          if(sections[i].offsetTop < currentScroll - 50){
            target = sections[i];
            break;
          }
        }
        if(target) target.scrollIntoView({ behavior: "smooth" });
      });
      navNextBtn.addEventListener("click", function(){
        const sections = Array.from(document.querySelectorAll("section"));
        const currentScroll = window.scrollY;
        let target = null;
        for(let i = 0; i < sections.length; i++){
          if(sections[i].offsetTop > currentScroll + 50){
            target = sections[i];
            break;
          }
        }
        if(target) target.scrollIntoView({ behavior: "smooth" });
      });

      //==============================
      // å´é‚Šé¸å–®ç›®å‰ä½ç½®é«˜äº®
      //==============================
      function updateSideMenuHighlight() {
        const sections = document.querySelectorAll("section");
        let currentSectionId = "";
        sections.forEach(sec => {
          if(window.scrollY >= sec.offsetTop - 100) {
            currentSectionId = sec.id;
          }
        });
        document.querySelectorAll("#sideMenu a").forEach(link => {
          if(link.getAttribute("href") === "#" + currentSectionId) {
            link.classList.add("active");
          } else {
            link.classList.remove("active");
          }
        });
      }

      //==============================
      // BigInt ç‰ˆæœ¬æ›ç®—ï¼šå›åˆè½‰å¡ç‰‡
      //==============================
      function roundsToCards(t){
        let T;
        try { T = BigInt(t); } catch(e){ return 0n; }
        if(T < 1n) return 0n;
        const baseThreshold = BigInt(CONFIG.baseThreshold);
        let r = T < baseThreshold ? T : baseThreshold;
        const baseArray = CONFIG.baseArray.map(x => BigInt(x));
        let base = (r / 5n) * 8n + baseArray[Number(r % 5n)];
        let extra = 0n;
        CONFIG.extraRanges.forEach(range => {
          let a = BigInt(range.a);
          let b = (range.b === Infinity) ? T : BigInt(range.b);
          let f = BigInt(range.f);
          if(T >= a){
            let x = T < b ? T : b;
            let term1 = x - a + 1n;
            let term2 = ((x + 1n) / 2n) - (a / 2n);
            extra += 2n * f * (term1 + 2n * term2);
          }
        });
        return base + extra;
      }
      //==============================
      // BigInt ç‰ˆæœ¬æ›ç®—ï¼šå¡ç‰‡è½‰å›åˆ
      //==============================
      function cardsToRounds(x){
        let X;
        try { X = BigInt(x); } catch(e){ return 0n; }
        if(X < 1n) return 0n;
        let l = 1n, h = 1n;
        while(roundsToCards(h) < X){ h *= 2n; }
        while(l < h){
          let m = (l + h) / 2n;
          if(roundsToCards(m) < X) l = m + 1n; else h = m;
        }
        return l;
      }

      //==============================
      // æ›ç®—éç¨‹æ‰“å­—å‹•ç•«ï¼šåƒ…è®“æœ€æ–°å‡ºç¾çš„å­—é™„æœ‰é–ƒçˆåœ“é»ï¼ˆé»é»å‹•ç•«ä½ç½®èª¿æ•´ï¼‰
      //==============================
      function animateProcessText(text) {
        if(processTextCache === text) return;
        processTextCache = text;
        typewriterIndex = 0;
        if(typewriterInterval) clearInterval(typewriterInterval);
        processInfo.innerHTML = "";
        let currentBlinker = null;
        typewriterInterval = setInterval(() => {
          if(typewriterIndex < text.length) {
            if(currentBlinker) {
              currentBlinker.remove();
              currentBlinker = null;
            }
            let charSpan = document.createElement("span");
            charSpan.className = "char";
            charSpan.textContent = text[typewriterIndex];
            let blinker = document.createElement("span");
            blinker.className = "blinker";
            blinker.textContent = "â—";
            charSpan.appendChild(blinker);
            currentBlinker = blinker;
            processInfo.appendChild(charSpan);
            requestAnimationFrame(() => { charSpan.style.opacity = "1"; });
            typewriterIndex++;
          } else {
            clearInterval(typewriterInterval);
            typewriterInterval = null;
          }
        }, 2);
      }

      //==============================
      // æ›´æ–°æ›ç®—çµæœèˆ‡æ›ç®—éç¨‹
      //==============================
      function updateResult(){
        let inputStr = inputValueElem.value.trim();
        if(!/^\d+$/.test(inputStr) || inputStr === "0"){
          resultDiv.innerText = translations[currentLang].calculator.invalidInput;
          resultDiv.classList.add("visible");
          return;
        }
        saveLS(LS_KEYS.lastInput, inputStr);
        let calcResult;
        if(mode === "r2c"){
          calcResult = roundsToCards(inputStr);
          resultDiv.innerText = "â†’ " + calcResult.toString() + translations[currentLang].units.r2c;
        } else {
          calcResult = cardsToRounds(inputStr);
          resultDiv.innerText = "â†’ " + calcResult.toString() + translations[currentLang].units.c2r;
        }
        resultDiv.classList.add("visible");
        // æ­¤è™•ä¸è‡ªå‹•å±•é–‹æ›ç®—éç¨‹ï¼Œä½¿ç”¨è€…å¯è‡ªè¡Œé»æ“Š processBtn é–‹å•Ÿ
        updateProcessInfo(inputStr);
        addHistoryRecord(Date.now(), mode, inputStr);
      }
      function updateProcessInfo(inputStr){
        if(resultDiv.innerText.trim() === "â†’") return;
        if(!/^\d+$/.test(inputStr) || inputStr === "0"){
          processInfo.innerHTML = "<pre>" + translations[currentLang].calculator.invalidInput + "</pre>";
          return;
        }
        let explanation = "";
        if(mode === "r2c"){
          explanation += translations[currentLang].process.r2cTitle + "\n\n";
          const r = BigInt(inputStr) < BigInt(CONFIG.baseThreshold) ? BigInt(inputStr) : BigInt(CONFIG.baseThreshold);
          const baseCalc = (r / 5n) * 8n;
          const baseArray = CONFIG.baseArray.map(x => BigInt(x));
          const lookup = baseArray[Number(r % 5n)];
          let subtotal = baseCalc + lookup;
          explanation += translations[currentLang].process.r2cStep1 + "\n";
          explanation += translations[currentLang].process.r2cLine1.replace("{input}", inputStr).replace("{r}", r.toString()) + "\n";
          explanation += translations[currentLang].process.r2cLine2.replace("{r}", r.toString()).replace("{baseCalc}", baseCalc.toString()) + "\n";
          explanation += translations[currentLang].process.r2cLine3.replace("{mod}", (r % 5n).toString()).replace("{lookup}", lookup.toString()) + "\n";
          explanation += translations[currentLang].process.r2cLine4.replace("{subtotal}", subtotal.toString()) + "\n\n";
          let extraTotal = 0n;
          if(BigInt(inputStr) > BigInt(CONFIG.baseThreshold)){
            explanation += translations[currentLang].process.r2cStep2 + "\n";
            CONFIG.extraRanges.forEach(range => {
              let a = BigInt(range.a);
              let b = (range.b === Infinity) ? BigInt(inputStr) : BigInt(range.b);
              let f = BigInt(range.f);
              if(BigInt(inputStr) >= a){
                let x = BigInt(inputStr) < b ? BigInt(inputStr) : b;
                let term1 = x - a + 1n;
                let term2 = ((x + 1n) / 2n) - (a / 2n);
                let extra = 2n * f * (term1 + 2n * term2);
                explanation += translations[currentLang].process.r2cLineExtra
                  .replace("{a}", a.toString())
                  .replace("{b}", (b === BigInt(inputStr) ? inputStr : b.toString()))
                  .replace("{f}", f.toString())
                  .replace("{extra}", extra.toString()) + "\n";
                extraTotal += extra;
              }
            });
            explanation += "\n" + translations[currentLang].process.r2cStep3
              .replace("{subtotal}", subtotal.toString())
              .replace("{extraTotal}", extraTotal.toString())
              .replace("{result}", roundsToCards(inputStr).toString()) + "\n";
          }
        } else {
          explanation += translations[currentLang].process.c2rTitle + "\n\n";
          explanation += translations[currentLang].process.c2rStep1 + "\n";
          let low = 1n, high = 1n;
          while(roundsToCards(high) < BigInt(inputStr)){ high *= 2n; }
          explanation += translations[currentLang].process.c2rStep2.replace("{high}", high.toString()) + "\n";
          while(low < high){
            let mid = (low + high) / 2n;
            explanation += translations[currentLang].process.c2rStep3.replace("{mid}", mid.toString()).replace("{cards}", roundsToCards(mid).toString()) + "\n";
            if(roundsToCards(mid) < BigInt(inputStr)) low = mid + 1n; else high = mid;
          }
          explanation += translations[currentLang].process.c2rStep4.replace("{result}", low.toString()) + "\n";
        }
        animateProcessText(explanation);
      }

      //==============================
      // åŠ å…¥æ»¾å‹•åˆ°é ‚ç«¯æŒ‰éˆ•
      //==============================
      function addProcessTopBtn(){
        if(!document.getElementById("processTopBtn")){
          const topBtn = document.createElement("button");
          topBtn.id = "processTopBtn";
          topBtn.innerHTML = "â¥”";
          topBtn.addEventListener("click", function(){
            processInfo.scrollTo({ top: 0, behavior: "smooth" });
          });
          processInfo.appendChild(topBtn);
        }
      }

      //==============================
      // å¸¸ç”¨æ›ç®—è¡¨æ ¼èˆ‡åœ–è¡¨ç”¢ç”Ÿ
      //==============================
      function populateTables(){
        const r2cValues = [111,200,300,1000,1500,2000,2500,10000,20000];
        const c2rValues = [40,400,4000,8000,12000,16000,20000,40000,400000];
        r2cValues.forEach(rounds => {
          const cards = roundsToCards(rounds);
          const tr = document.createElement("tr");
          tr.innerHTML = `<td>${rounds}</td><td>${cards.toString()}</td>`;
          r2cTableBody.appendChild(tr);
        });
        c2rValues.forEach(cards => {
          const rounds = cardsToRounds(cards);
          const tr = document.createElement("tr");
          tr.innerHTML = `<td>${cards}</td><td>${rounds.toString()}</td>`;
          c2rTableBody.appendChild(tr);
        });
      }
      function generateChart(){
        const dataPoints = [];
        const maxRounds = CONFIG.chart.maxRounds;
        const step = CONFIG.chart.step;
        for(let r=0; r<=maxRounds; r+=step){
          dataPoints.push({x: r, y: Number(roundsToCards(r))});
        }
        const maxY = Number(roundsToCards(maxRounds));
        const ctx = document.getElementById("chart").getContext("2d");
        if(myChart) myChart.destroy();
        const t = translations[currentLang];
        const datasetOptions = {
          label: t.chart.yAxis,
          data: dataPoints,
          borderColor: "rgba(75,192,192,1)",
          backgroundColor: "rgba(75,192,192,0.2)",
          pointRadius: togglePointsCheckbox.checked ? 4 : 0,
          fill: false,
          tension: 0.15
        };
        const chartOptions = {
          type: currentChartType,
          data: { datasets: [ datasetOptions ] },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            animation: { duration: 1000, easing: 'easeInOutQuad' },
            plugins: {
              tooltip: {
                mode: "index",
                intersect: false,
                callbacks: {
                  label: function(context){
                    return t.chart.xAxis + ": " + context.parsed.x + ", " + t.chart.yAxis + ": " + context.parsed.y;
                  }
                }
              },
              datalabels: { display: false }
            },
            scales: {
              x: {
                type: "linear",
                title: { display: true, text: t.chart.xAxis },
                min: 0,
                max: maxRounds,
                ticks: { font: { size: 14 }, color: body.classList.contains("dark") ? "#fff" : "#333" },
                grid: { display: toggleGridCheckbox.checked }
              },
              y: {
                title: { display: true, text: t.chart.yAxis },
                min: 0,
                max: maxY,
                ticks: { 
                  stepSize: 3000, 
                  callback: function(value) { return Math.round(value); },
                  font: { size: 14 }, 
                  color: body.classList.contains("dark") ? "#fff" : "#333" 
                },
                grid: { display: toggleGridCheckbox.checked }
              }
            }
          }
        };
        if(toggleAnnotationsCheckbox.checked){
          chartOptions.options.plugins.annotation = {
            annotations: {
              line45: {
                type: "line",
                scaleID: "x",
                value: 45,
                borderColor: "rgba(255,0,0,0.8)",
                borderWidth: 2,
                borderDash: [6,3],
                label: {
                  enabled: true,
                  position: "start",
                  yAdjust: 10,
                  content: ["45" + t.chart.roundSuffix, roundsToCards(45).toString()],
                  backgroundColor: "rgba(0,0,0,0.7)",
                  color: "#fff",
                  font: { weight: "bold", size: 12 },
                  borderRadius: 4,
                  padding: 4
                }
              },
              line111: {
                type: "line",
                scaleID: "x",
                value: 111,
                borderColor: "rgba(255,0,0,0.8)",
                borderWidth: 2,
                borderDash: [6,3],
                label: {
                  enabled: true,
                  position: "start",
                  yAdjust: 10,
                  content: ["111" + t.chart.roundSuffix, roundsToCards(111).toString()],
                  backgroundColor: "rgba(0,0,0,0.7)",
                  color: "#fff",
                  font: { weight: "bold", size: 12 },
                  borderRadius: 4,
                  padding: 4
                }
              },
              line501: {
                type: "line",
                scaleID: "x",
                value: 501,
                borderColor: "rgba(255,0,0,0.8)",
                borderWidth: 2,
                borderDash: [6,3],
                label: {
                  enabled: true,
                  position: "start",
                  yAdjust: 10,
                  content: ["501" + t.chart.roundSuffix, roundsToCards(501).toString()],
                  backgroundColor: "rgba(0,0,0,0.7)",
                  color: "#fff",
                  font: { weight: "bold", size: 12 },
                  borderRadius: 4,
                  padding: 4
                }
              },
              line1001: {
                type: "line",
                scaleID: "x",
                value: 1001,
                borderColor: "rgba(255,0,0,0.8)",
                borderWidth: 2,
                borderDash: [6,3],
                label: {
                  enabled: true,
                  position: "start",
                  yAdjust: 10,
                  content: ["1001" + t.chart.roundSuffix, roundsToCards(1001).toString()],
                  backgroundColor: "rgba(0,0,0,0.7)",
                  color: "#fff",
                  font: { weight: "bold", size: 12 },
                  borderRadius: 4,
                  padding: 4
                }
              },
              line1501: {
                type: "line",
                scaleID: "x",
                value: 1501,
                borderColor: "rgba(255,0,0,0.8)",
                borderWidth: 2,
                borderDash: [6,3],
                label: {
                  enabled: true,
                  position: "start",
                  yAdjust: 10,
                  content: ["1501" + t.chart.roundSuffix, roundsToCards(1501).toString()],
                  backgroundColor: "rgba(0,0,0,0.7)",
                  color: "#fff",
                  font: { weight: "bold", size: 12 },
                  borderRadius: 4,
                  padding: 4
                }
              }
            }
          };
        }
        myChart = new Chart(ctx, chartOptions);
      }
      chartTypeSelect.addEventListener("change", function(){
        currentChartType = this.value;
        generateChart();
      });
      toggleAnnotationsCheckbox.addEventListener("change", generateChart);
      togglePointsCheckbox.addEventListener("change", generateChart);
      toggleGridCheckbox.addEventListener("change", generateChart);

      //==============================
      // æ›ç®—æ¨¡å¼åˆ‡æ›
      //==============================
      btnR2C.addEventListener("click", function(){
        mode = "r2c";
        btnR2C.classList.add("active");
        btnC2R.classList.remove("active");
        saveLS(LS_KEYS.mode, mode);
        if(resultDiv.innerText.trim() !== "â†’") { updateResult(); }
      });
      btnC2R.addEventListener("click", function(){
        mode = "c2r";
        btnC2R.classList.add("active");
        btnR2C.classList.remove("active");
        saveLS(LS_KEYS.mode, mode);
        if(resultDiv.innerText.trim() !== "â†’") { updateResult(); }
      });
      calcBtn.addEventListener("click", updateResult);
      processBtn.addEventListener("click", function(e){
        e.stopPropagation();
        // ä½¿ç”¨è€…é»æ“Šæ™‚æ‰‹å‹•å±•é–‹æˆ–æ”¶èµ·æ›ç®—éç¨‹
        processInfo.classList.toggle("visible");
        if(processInfo.classList.contains("visible") && !typewriterInterval && typewriterIndex < processTextCache.length) {
          animateProcessText(processTextCache);
        }
        updateResult();
      });
      processInfo.addEventListener("wheel", function(e){ e.stopPropagation(); });

      //==============================
      // æ›ç®—æ­·å²è¨˜éŒ„åŠŸèƒ½ï¼ˆåˆ†é ï¼‰
      //==============================
      function addHistoryRecord(timestamp, modeUsed, input){
        const record = { timestamp, mode: modeUsed, input };
        historyData.unshift(record);
        saveLS(LS_KEYS.history, historyData);
        currentHistoryPage = 0;
        renderHistory();
      }
      function renderHistory(){
        historyTableBody.innerHTML = "";
        if(historyData.length === 0){
          const tr = document.createElement("tr");
          tr.innerHTML = `<td colspan='4'>${translations[currentLang].history.noRecord}</td>`;
          historyTableBody.appendChild(tr);
        } else {
          historyData.slice(currentHistoryPage * recordsPerPage, (currentHistoryPage+1)*recordsPerPage)
            .forEach(rec => {
              const tr = document.createElement("tr");
              const timeStr = new Date(rec.timestamp).toLocaleString(getLocale(currentLang));
              let computed = (rec.mode === "r2c") ? roundsToCards(rec.input) : cardsToRounds(rec.input);
              let resultText = "â†’ " + computed.toString() + (rec.mode === "r2c" ? translations[currentLang].units.r2c : translations[currentLang].units.c2r);
              let modeText = (rec.mode === "r2c") ? translations[currentLang].calculator.modeR2C : translations[currentLang].calculator.modeC2R;
              tr.innerHTML = `<td>${timeStr}</td><td>${modeText}</td><td>${rec.input}</td><td>${resultText}</td>`;
              historyTableBody.appendChild(tr);
            });
        }
        renderHistoryPagination();
      }
      function renderHistoryPagination(){
        historyPagination.innerHTML = "";
        const totalPages = Math.ceil(historyData.length / recordsPerPage);
        if(totalPages <= 1) return;
        const paginationDiv = document.createElement("div");
        if(currentHistoryPage > 0){
          const prevBtn = document.createElement("button");
          prevBtn.textContent = translations[currentLang].pagination.prev;
          prevBtn.style.marginRight = "1rem";
          prevBtn.addEventListener("click", function(){
            currentHistoryPage--;
            renderHistory();
          });
          paginationDiv.appendChild(prevBtn);
        }
        const pageInfo = document.createElement("span");
        pageInfo.textContent = translations[currentLang].pagination.pageInfo
          .replace("{current}", currentHistoryPage + 1)
          .replace("{total}", totalPages);
        paginationDiv.appendChild(pageInfo);
        if(currentHistoryPage < totalPages - 1){
          const nextBtn = document.createElement("button");
          nextBtn.textContent = translations[currentLang].pagination.next;
          nextBtn.style.marginLeft = "1rem";
          nextBtn.addEventListener("click", function(){
            currentHistoryPage++;
            renderHistory();
          });
          paginationDiv.appendChild(nextBtn);
        }
        historyPagination.appendChild(paginationDiv);
      }
      clearHistoryBtn.addEventListener("click", function(){
        if(confirm("ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰æ­·å²è¨˜éŒ„å—ï¼Ÿ")){
          historyData = [];
          saveLS(LS_KEYS.history, historyData);
          currentHistoryPage = 0;
          renderHistory();
        }
      });

      //==============================
      // èªè¨€åˆ‡æ›åŠŸèƒ½
      //==============================
      function updateLanguage() {
         currentLang = langSelect.value;
         const t = translations[currentLang];
         document.querySelector("#calculator .module h2").textContent = t.calculator.title;
         document.querySelector("#common .module h2").textContent = t.common.title;
         document.querySelector("#chartSection .module h2").textContent = t.chart.title;
         document.querySelector("#history .module h2").textContent = t.history.title;
         document.getElementById("btnR2C").textContent = t.calculator.modeR2C;
         document.getElementById("btnC2R").textContent = t.calculator.modeC2R;
         document.querySelector("#calculator label[for='inputValue']").textContent = t.calculator.inputLabel;
         document.getElementById("calcBtn").textContent = t.calculator.calcBtn;
         document.getElementById("processBtn").textContent = t.calculator.processBtn;
         let chartLabel = document.querySelector("#chartSection label[for='chartType']");
         if(chartLabel) { chartLabel.textContent = t.chart.chartTypeLabel; }
         const chartTypeSelect = document.getElementById("chartType");
         if(chartTypeSelect) {
           chartTypeSelect.options[0].text = t.chart.optionLine;
           chartTypeSelect.options[1].text = t.chart.optionBar;
         }
         document.getElementById("annotationsLabel").textContent = t.chart.showAnnotationsLabel;
         document.getElementById("pointsLabel").textContent = t.chart.showPointsLabel;
         document.getElementById("gridLabel").textContent = t.chart.showGridLabel;
         document.getElementById("clearHistory").textContent = t.history.clearHistory;
         let r2cHeaders = document.querySelectorAll("#r2cTable thead tr th");
         r2cHeaders[0].textContent = t.tables.r2c.header1;
         r2cHeaders[1].textContent = t.tables.r2c.header2;
         let c2rHeaders = document.querySelectorAll("#c2rTable thead tr th");
         c2rHeaders[0].textContent = t.tables.c2r.header1;
         c2rHeaders[1].textContent = t.tables.c2r.header2;
         let historyHeaders = document.querySelectorAll("#historyTable thead tr th");
         historyHeaders[0].textContent = t.tables.history.header1;
         historyHeaders[1].textContent = t.tables.history.header2;
         historyHeaders[2].textContent = t.tables.history.header3;
         historyHeaders[3].textContent = t.tables.history.header4;
         document.getElementById("menuCalculator").textContent = t.nav.calculator;
         document.getElementById("menuCommon").textContent = t.nav.common;
         document.getElementById("menuChartSection").textContent = t.nav.chartSection;
         document.getElementById("menuHistory").textContent = t.nav.history;
         siteTitleSub.textContent = t.siteTitleSub;
         document.getElementById("hiddenCredits").textContent = t.credits;
         renderToggleBtn();
         renderHistory();
         generateChart();
         // è‹¥æ›ç®—éç¨‹å€åŸæœ¬å·²å±•é–‹ï¼Œå‰‡ä¸è‡ªå‹•é‡æ’­æ‰“å­—å‹•ç•«
      }
      langSelect.addEventListener("change", updateLanguage);

      //==============================
      // åˆå§‹å¡«å……è¡¨æ ¼ã€åœ–è¡¨ã€è¼‰å…¥åå¥½èˆ‡ç¿»è­¯
      //==============================
      populateTables();
      generateChart();
      initPreferences();
      updateChartAxisColor();

      //==============================
      // æ›´æ–°åœ–è¡¨è»¸è‰²å½©ï¼ˆæš—å¤œæ¨¡å¼æ™‚ï¼‰
      //==============================
      function updateChartAxisColor(){
        if(myChart){
          myChart.options.scales.x.ticks.color = body.classList.contains("dark") ? "#fff" : "#333";
          myChart.options.scales.y.ticks.color = body.classList.contains("dark") ? "#fff" : "#333";
          myChart.update();
        }
      }

      //==============================
      // å½©è›‹åŠŸèƒ½ï¼šé»æ“Šç¶²ç«™æ¨™é¡Œè§¸ç™¼æµ®å‹• ğŸ¤” emoji
      //==============================
      function triggerEasterEgg() {
        eggClickCount++;
        if(eggTimeout) clearTimeout(eggTimeout);
        eggTimeout = setTimeout(() => { eggClickCount = 0; easterEggText.textContent = ""; }, 5000);
        const floatEmoji = document.createElement("span");
        floatEmoji.textContent = "ğŸ¤”";
        floatEmoji.style.position = "fixed";
        floatEmoji.style.zIndex = "9999";
        const randomX = Math.random() * 80 + 10;
        floatEmoji.style.left = randomX + "%";
        floatEmoji.style.bottom = "0px";
        floatEmoji.style.fontSize = "2.5rem";
        floatEmoji.style.opacity = "1";
        floatEmoji.style.pointerEvents = "none";
        floatEmoji.style.transition = "transform 3s ease-out, opacity 3s ease-out";
        document.body.appendChild(floatEmoji);
        setTimeout(() => {
          floatEmoji.style.transform = "translateY(-120vh) rotate(" + (Math.random()*20-10) + "deg) scale(2)";
          floatEmoji.style.opacity = "0";
        }, 50);
        setTimeout(() => { floatEmoji.remove(); }, 3050);
        const tEgg = translations[currentLang].easterEgg;
        switch(eggClickCount){
          case 1:  easterEggText.textContent = tEgg.click1;  break;
          case 3:  easterEggText.textContent = tEgg.click3;  break;
          case 5:  easterEggText.textContent = tEgg.click5;  break;
          case 7:  easterEggText.textContent = tEgg.click7;  break;
          case 10: easterEggText.textContent = tEgg.click10; break;
          case 15: easterEggText.textContent = tEgg.click15; break;
          case 25: easterEggText.textContent = tEgg.click25; break;
          case 35: easterEggText.textContent = tEgg.click35; break;
          case 45: easterEggText.textContent = tEgg.click45; break;
          case 60: easterEggText.textContent = tEgg.click60; break;
          default:
            if(eggClickCount >= 80){
              easterEggText.textContent = tEgg.click80;
            }
            break;
        }
      }
      // å°‡é»æ“Šäº‹ä»¶ç¶å®šåœ¨æ•´å€‹ #siteTitleContainer ä¸Šï¼ˆåŒ…æ‹¬æ¨™é¡Œæ–‡å­—ï¼‰
      siteTitleContainer.addEventListener("click", triggerEasterEgg);

      //==============================
      // æ›ç®—éç¨‹æ‰“å­—å‹•ç•«ï¼šåƒ…è®“æœ€æ–°å‡ºç¾çš„å­—é™„æœ‰é–ƒçˆåœ“é»
      //==============================
      function animateProcessText(text) {
        if(processTextCache === text) return;
        processTextCache = text;
        typewriterIndex = 0;
        if(typewriterInterval) clearInterval(typewriterInterval);
        processInfo.innerHTML = "";
        let currentBlinker = null;
        typewriterInterval = setInterval(() => {
          if(typewriterIndex < text.length) {
            if(currentBlinker) {
              currentBlinker.remove();
              currentBlinker = null;
            }
            let charSpan = document.createElement("span");
            charSpan.className = "char";
            charSpan.textContent = text[typewriterIndex];
            let blinker = document.createElement("span");
            blinker.className = "blinker";
            blinker.textContent = "â—";
            charSpan.appendChild(blinker);
            currentBlinker = blinker;
            processInfo.appendChild(charSpan);
            requestAnimationFrame(() => { charSpan.style.opacity = "1"; });
            typewriterIndex++;
          } else {
            clearInterval(typewriterInterval);
            typewriterInterval = null;
          }
        }, 2);
      }

      //==============================
      // é€²å…¥ç¶²é æ™‚çš„å‹•ç•«æ•ˆæœ
      //==============================
      window.addEventListener("load", function(){
        // 1. é è¨­å´é‚Šæ¬„é–‹å•Ÿä¸¦æ¨™é¡Œå€é«˜äº® 1 ç§’
        sideMenu.classList.remove("collapsed");
        siteTitleContainer.classList.add("highlight");
        setTimeout(function(){
          siteTitleContainer.classList.remove("highlight");
        }, 1000);
        // 2. 20 å€‹ ğŸ¤” ç¬¦è™Ÿå¾è¢å¹•åº•éƒ¨ä¾åºé£„å‡ºï¼ˆ2 ç§’å…§ï¼‰ï¼Œä¸¦ç¢ºä¿ z-index åœ¨æœ€ä¸Šå±¤
        for(let i = 0; i < 20; i++){
          setTimeout(function(){
            let emoji = document.createElement("span");
            emoji.textContent = "ğŸ¤”";
            emoji.style.position = "fixed";
            emoji.style.bottom = "0px";
            emoji.style.left = (Math.random() * 80 + 10) + "%";
            emoji.style.fontSize = "2rem";
            emoji.style.opacity = "1";
            emoji.style.pointerEvents = "none";
            emoji.style.zIndex = "9999";
            emoji.style.transition = "transform 2s ease-out, opacity 2s ease-out";
            document.body.appendChild(emoji);
            requestAnimationFrame(function(){
              emoji.style.transform = "translateY(-100vh) scale(1.5)";
              emoji.style.opacity = "0";
            });
            setTimeout(function(){ emoji.remove(); }, 2100);
          }, i * 100);
        }
        // 3. 2 ç§’å¾Œæ”¶èµ·å´é‚Šæ¬„
        setTimeout(function(){
          sideMenu.classList.add("collapsed");
          sideMenuToggle.style.left = "0px";
        }, 2000);
        // 4. æ”¶èµ·å¾Œå´é‚Šæ¬„é–‹é—œæŒ‰éˆ•é«˜äº®æç¤º 2 ç§’ï¼Œä¸¦å¾å…¶è™•ä¾åºé£„å‡º 3 å€‹ ğŸ¤” ç¬¦è™Ÿï¼ˆä¸é‡ç–Šä¸” z-index æœ€é«˜ï¼‰
        setTimeout(function(){
          sideMenuToggle.classList.add("highlight-long");
          let rect = sideMenuToggle.getBoundingClientRect();
          for(let j = 0; j < 3; j++){
            setTimeout(function(){
              let emoji = document.createElement("span");
              emoji.textContent = "ğŸ¤”";
              emoji.style.position = "fixed";
              emoji.style.left = (rect.left + j * 20) + "px";
              emoji.style.top = rect.top + "px";
              emoji.style.fontSize = "1.5rem";
              emoji.style.opacity = "1";
              emoji.style.pointerEvents = "none";
              emoji.style.zIndex = "9999";
              emoji.style.transition = "transform 2s ease-out, opacity 2s ease-out";
              document.body.appendChild(emoji);
              requestAnimationFrame(function(){
                emoji.style.transform = "translateY(-50px)";
                emoji.style.opacity = "0";
              });
              setTimeout(function(){ emoji.remove(); }, 2100);
            }, j * 300);
          }
          setTimeout(function(){
            sideMenuToggle.classList.remove("highlight-long");
          }, 2000);
        }, 2100);
      });

    })();
  </script>
</body>
</html>
